var Bermuda,__bind=function(t,n){return function(){return t.apply(n,arguments)}},__slice=[].slice;Bermuda=function(){function t(t,o){this.elem=t,null==o&&(o={}),this.redrawPolygon=__bind(this.redrawPolygon,this),this.settings=e(n,o),this.initMap(),this.initIcon()}var n,o,e,r,i;return n={disabled:!1,autoCentered:!0,marker:{},polygon:{},icon:{},map:{},onChange:function(){}},t.prototype.markers=[],t.prototype.polygon=null,t.prototype.icon=null,e=function(){var t,n,o,e,r,i,s;for(e=1<=arguments.length?__slice.call(arguments,0):[],t={},i=0,s=e.length;s>i;i++){o=e[i];for(n in o)r=o[n],t[n]=r}return t},t.prototype.initMap=function(){return this.map=new google.maps.Map(this.elem,this.settings.map)},t.prototype.initIcon=function(){var t;if(!o(this.settings.icon))return t=new google.maps.Size(this.settings.icon.width,this.settings.icon.height),this.icon=new google.maps.MarkerImage(this.settings.icon.image,null,null,null,t)},o=function(t){var n;for(n in t)if(t.hasOwnProperty(n))return!1;return!0},t.prototype.clear=function(){return this.removeMarkers(),this.polygon?r(this.polygon):void 0},t.prototype.removeMarkers=function(){return this.detachMarkers(),this.markers=[]},t.prototype.detachMarkers=function(){var t,n,o,e,r;for(e=this.markers,r=[],n=0,o=e.length;o>n;n++)t=e[n],r.push(t.setMap(null));return r},t.prototype.disable=function(){return this.detachMarkers(),this.settings.disabled=!0},t.prototype.enable=function(){var t,n,o,e;for(e=this.markers,n=0,o=e.length;o>n;n++)t=e[n],t.setMap(this.map);return this.settings.disabled=!1},t.prototype.draw=function(t){return this.clear(),this.initMarkers(t),this.initPolygon()},t.prototype.initMarkers=function(t){var n,o,e,r;for(r=i(t),o=0,e=r.length;e>o;o++)n=r[o],this.markers.push(this.createMarker(n));return this.listen("dragend",function(t){return function(){return t.settings.onChange(t.getCoords())}}(this)),this.settings.autoCentered?this.autoCenter():void 0},i=function(t){var n,o,e,r;for(r=[],o=0,e=t.length;e>o;o++)n=t[o],r.push(new google.maps.LatLng(n[0],n[1]));return r},t.prototype.createMarker=function(t){var n;return n=new google.maps.Marker(e(this.settings.marker,{position:t,draggable:!0,icon:this.icon})),this.settings.disabled||n.setMap(this.map),n},t.prototype.autoCenter=function(){var t,n,o,e,r;for(t=new google.maps.LatLngBounds,r=this.getPositions(),o=0,e=r.length;e>o;o++)n=r[o],t.extend(n);return this.map.fitBounds(t)},t.prototype.listen=function(t,n){var o,e,r,i,s;for(i=this.markers,s=[],e=0,r=i.length;r>e;e++)o=i[e],s.push(google.maps.event.addListener(o,t,n));return s},t.prototype.initPolygon=function(){return this.drawPolygon(),this.listen("drag",this.redrawPolygon)},t.prototype.redrawPolygon=function(){var t;return t=this.polygon,this.drawPolygon(),r(t)},t.prototype.getPositions=function(){var t,n,o,e,r;for(e=this.markers,r=[],n=0,o=e.length;o>n;n++)t=e[n],r.push(t.position);return r},t.prototype.getCoords=function(){var t,n,o,e,r;for(e=this.markers,r=[],n=0,o=e.length;o>n;n++)t=e[n],r.push([t.position.lat(),t.position.lng()]);return r},r=function(t){return t.setMap(null)},t.prototype.drawPolygon=function(){return this.polygon=new google.maps.Polygon(e(this.settings.polygon,{map:this.map,paths:this.getPositions(),draggable:!1,geodesic:!0}))},t.prototype.zoomIn=function(){return this.map.setZoom(this.map.zoom+1)},t.prototype.zoomOut=function(){return this.map.setZoom(this.map.zoom-1)},t}();